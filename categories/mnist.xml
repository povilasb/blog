<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Povilas Blog (Posts about mnist)</title><link>http://blog.povilasb.com/</link><description></description><atom:link href="http://blog.povilasb.com/categories/mnist.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 11 Dec 2022 18:28:53 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>MNIST with scikit-learn</title><link>http://blog.povilasb.com/posts/mnist-with-scikit-learn/</link><dc:creator>Povilas Balciunas</dc:creator><description>&lt;p&gt;Solving &lt;a class="reference external" href="http://yann.lecun.com/exdb/mnist/"&gt;MNIST&lt;/a&gt; with &lt;a class="reference external" href="http://scikit-learn.org/"&gt;scikit-learn&lt;/a&gt; is easy.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-1" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-1" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;datasets&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-2" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-2" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.neighbors&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;KNeighborsClassifier&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-3" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-3" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-3"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.model_selection&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-4" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-4" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-4"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.metrics&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;accuracy_score&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-5" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-5" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-6" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-6" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;mnist&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;datasets&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fetch_mldata&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'MNIST original'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;data_home&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="s1"&gt;'data'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-7" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-7" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;train_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;train_labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;test_labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;train_test_split&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-8" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-8" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;mnist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;mnist&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-9" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-9" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-9"&gt;&lt;/a&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-10" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-10" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KNeighborsClassifier&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-11" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-11" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-11"&gt;&lt;/a&gt;&lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;train_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;train_labels&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-12" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-12" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-12"&gt;&lt;/a&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-13" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-13" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-13"&gt;&lt;/a&gt;&lt;span class="n"&gt;predicted_labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_e91578da48aa4a23b03ca33a4c2b430a-14" name="rest_code_e91578da48aa4a23b03ca33a4c2b430a-14" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_e91578da48aa4a23b03ca33a4c2b430a-14"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'Prediction accuracy:'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;accuracy_score&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_labels&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;predicted_labels&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;I get 97% accuracy which is great for such a simple implementation.&lt;/p&gt;
&lt;p&gt;With &lt;cite&gt;train_test_split()&lt;/cite&gt; I split the data into training and testing segments.
For simplicity I used K-nearest neighbour classifier but potentially others
could be used too (&lt;a class="reference external" href="http://brianfarris.me/static/digit_recognizer.html"&gt;http://brianfarris.me/static/digit_recognizer.html&lt;/a&gt;).&lt;/p&gt;
&lt;section id="reusability"&gt;
&lt;h2&gt;Reusability&lt;/h2&gt;
&lt;p&gt;&lt;cite&gt;clf.fit()&lt;/cite&gt; takes some time to train the classifier.
But we can store the trained classifier on disk and reuse it multiple times:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-1" name="rest_code_34497f195d3f480aa2bafd0b138735b6-1" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;from&lt;/span&gt; &lt;span class="nn"&gt;sklearn.externals&lt;/span&gt; &lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="n"&gt;joblib&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-2" name="rest_code_34497f195d3f480aa2bafd0b138735b6-2" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-3" name="rest_code_34497f195d3f480aa2bafd0b138735b6-3" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;KNeighborsClassifier&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-4" name="rest_code_34497f195d3f480aa2bafd0b138735b6-4" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;fit&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;train_data&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;train_labels&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-5" name="rest_code_34497f195d3f480aa2bafd0b138735b6-5" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-5"&gt;&lt;/a&gt;&lt;span class="n"&gt;joblib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;dump&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'classifier_model.pkl'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-6" name="rest_code_34497f195d3f480aa2bafd0b138735b6-6" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-6"&gt;&lt;/a&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-7" name="rest_code_34497f195d3f480aa2bafd0b138735b6-7" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-7"&gt;&lt;/a&gt;&lt;span class="c1"&gt;# ...&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-8" name="rest_code_34497f195d3f480aa2bafd0b138735b6-8" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-8"&gt;&lt;/a&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-9" name="rest_code_34497f195d3f480aa2bafd0b138735b6-9" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-9"&gt;&lt;/a&gt;&lt;span class="n"&gt;clf&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;joblib&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'classifier_model.pkl'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_34497f195d3f480aa2bafd0b138735b6-10" name="rest_code_34497f195d3f480aa2bafd0b138735b6-10" href="http://blog.povilasb.com/posts/mnist-with-scikit-learn/#rest_code_34497f195d3f480aa2bafd0b138735b6-10"&gt;&lt;/a&gt;&lt;span class="n"&gt;predicted_labels&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;clf&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;predict&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;test_data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;The serialized classifier takes up to 520 MB on disk.&lt;/p&gt;
&lt;/section&gt;</description><category>machine learning</category><category>mnist</category><category>python</category><category>scikit-learn</category><guid>http://blog.povilasb.com/posts/mnist-with-scikit-learn/</guid><pubDate>Mon, 20 Feb 2017 19:19:15 GMT</pubDate></item></channel></rss>