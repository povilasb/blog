<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Povilas Blog (Posts about ssl)</title><link>http://blog.povilasb.com/</link><description></description><atom:link href="http://blog.povilasb.com/categories/cat_ssl.xml" rel="self" type="application/rss+xml"></atom:link><language>en</language><lastBuildDate>Sun, 11 Dec 2022 18:28:53 GMT</lastBuildDate><generator>Nikola (getnikola.com)</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Python SSL MemoryBIO usage</title><link>http://blog.povilasb.com/posts/python-ssl-memorybio-usage/</link><dc:creator>Povilas Balciunas</dc:creator><description>&lt;p&gt;OpenSSL has a basic I/O abstraction which is abbreviated as BIO.&lt;/p&gt;
&lt;p&gt;This abstraction let's you encode raw stream to TLS and back in memory -
without actually doing any network I/O.&lt;/p&gt;
&lt;p&gt;Python 3.5 introduced an API to use this feature:
&lt;a class="reference external" href="https://docs.python.org/3/library/ssl.html#memory-bio-support"&gt;https://docs.python.org/3/library/ssl.html#memory-bio-support&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I haven't found any samples/tutorials how to use these objects, so I'm
going to describe it briefly.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLObject"&gt;SSLObject&lt;/a&gt; and
&lt;a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.MemoryBIO"&gt;MemoryBIO&lt;/a&gt; are
the core objects to do TLS.
&lt;cite&gt;SSLObject&lt;/cite&gt; does the data encryption/decryption and &lt;cite&gt;MemoryBIO&lt;/cite&gt; objects
are used to feed data to &lt;cite&gt;SSLObject&lt;/cite&gt; and receive it back.&lt;/p&gt;
&lt;p&gt;The only way to create &lt;cite&gt;SSLObject&lt;/cite&gt; is to use
&lt;a class="reference external" href="https://docs.python.org/3/library/ssl.html#ssl.SSLContext.wrap_bio"&gt;SSLContext.wrap_bio()&lt;/a&gt;.&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-1" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-1" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;ssl&lt;/span&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-2" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-2" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-2"&gt;&lt;/a&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-3" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-3" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-3"&gt;&lt;/a&gt;&lt;span class="n"&gt;tls_in_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-4" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-4" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-4"&gt;&lt;/a&gt;&lt;span class="n"&gt;tls_out_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-5" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-5" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-5"&gt;&lt;/a&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-6" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-6" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-6"&gt;&lt;/a&gt;&lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSLContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTOCOL_SSLv23&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-7" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-7" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-7"&gt;&lt;/a&gt;&lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_cert_chain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'localhost.crt'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'private_key.pem'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-8" name="rest_code_9dfea63c8e0a48aca954f7bbe62ad436-8" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_9dfea63c8e0a48aca954f7bbe62ad436-8"&gt;&lt;/a&gt;&lt;span class="n"&gt;tls_obj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap_bio&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server_side&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To decrypt data we write it into input &lt;cite&gt;MemoryBIO&lt;/cite&gt; object and then read
the raw data from &lt;cite&gt;SSLObject&lt;/cite&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_39fd1679073a43a9bec35a69605b7445-1" name="rest_code_39fd1679073a43a9bec35a69605b7445-1" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_39fd1679073a43a9bec35a69605b7445-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4096&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;a id="rest_code_39fd1679073a43a9bec35a69605b7445-2" name="rest_code_39fd1679073a43a9bec35a69605b7445-2" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_39fd1679073a43a9bec35a69605b7445-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;http_req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;a id="rest_code_39fd1679073a43a9bec35a69605b7445-3" name="rest_code_39fd1679073a43a9bec35a69605b7445-3" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_39fd1679073a43a9bec35a69605b7445-3"&gt;&lt;/a&gt;&lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;http_req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;To encrypt data we write into &lt;cite&gt;SSLObject&lt;/cite&gt; and then read the encrypted data
from output &lt;cite&gt;MemoryBIO&lt;/cite&gt;:&lt;/p&gt;
&lt;div class="code"&gt;&lt;pre class="code python"&gt;&lt;a id="rest_code_846e1cee8cf8471f88dbac47342f2bac-1" name="rest_code_846e1cee8cf8471f88dbac47342f2bac-1" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_846e1cee8cf8471f88dbac47342f2bac-1"&gt;&lt;/a&gt;&lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;'HTTP/1.1 200 OK&lt;/span&gt;&lt;span class="se"&gt;\r\n\r\n&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;a id="rest_code_846e1cee8cf8471f88dbac47342f2bac-2" name="rest_code_846e1cee8cf8471f88dbac47342f2bac-2" href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_846e1cee8cf8471f88dbac47342f2bac-2"&gt;&lt;/a&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Basically encryption/decryption could be depicted as:&lt;/p&gt;
&lt;pre class="literal-block"&gt;     b'data'    b'\x17\x03\x03\x00\x1c\xc1...'
        |                  |
write() |                  | write()
        |                  v
        |             +-----------+
        |             |   input   |
        |             | MemoryBIO |
        |             +-----------+
        |                  |
        v                  v
     +-----------------------------+
     |                             |
     |          SSLObject          |
     |                             |
     +-----------------------------+
        |                 |
        |                 | read()
        v                 v
  +-----------+         b'data'
  |   output  |
  | MemoryBIO |
  +-----------+
       |
read() |
       V

b'\x17\x03\x03\x00\x1c\xc1...'&lt;/pre&gt;
&lt;section id="sample-https-server"&gt;
&lt;h2&gt;Sample HTTPS Server&lt;/h2&gt;
&lt;div class="code"&gt;&lt;table class="codetable"&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-1"&gt;&lt;code data-line-number=" 1"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-1" name="rest_code_095f5aea8f354d988a71f02eb47a8651-1"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-2"&gt;&lt;code data-line-number=" 2"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-2" name="rest_code_095f5aea8f354d988a71f02eb47a8651-2"&gt;&lt;/a&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;ssl&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-3"&gt;&lt;code data-line-number=" 3"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-3" name="rest_code_095f5aea8f354d988a71f02eb47a8651-3"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-4"&gt;&lt;code data-line-number=" 4"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-4" name="rest_code_095f5aea8f354d988a71f02eb47a8651-4"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-5"&gt;&lt;code data-line-number=" 5"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-5" name="rest_code_095f5aea8f354d988a71f02eb47a8651-5"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;do_tls_handshake&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-6"&gt;&lt;code data-line-number=" 6"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-6" name="rest_code_095f5aea8f354d988a71f02eb47a8651-6"&gt;&lt;/a&gt;                     &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-7"&gt;&lt;code data-line-number=" 7"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-7" name="rest_code_095f5aea8f354d988a71f02eb47a8651-7"&gt;&lt;/a&gt;    &lt;span class="n"&gt;client_hello&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4096&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-8"&gt;&lt;code data-line-number=" 8"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-8" name="rest_code_095f5aea8f354d988a71f02eb47a8651-8"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client_hello&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-9"&gt;&lt;code data-line-number=" 9"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-9" name="rest_code_095f5aea8f354d988a71f02eb47a8651-9"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-10"&gt;&lt;code data-line-number="10"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-10" name="rest_code_095f5aea8f354d988a71f02eb47a8651-10"&gt;&lt;/a&gt;    &lt;span class="k"&gt;try&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-11"&gt;&lt;code data-line-number="11"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-11" name="rest_code_095f5aea8f354d988a71f02eb47a8651-11"&gt;&lt;/a&gt;        &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_handshake&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-12"&gt;&lt;code data-line-number="12"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-12" name="rest_code_095f5aea8f354d988a71f02eb47a8651-12"&gt;&lt;/a&gt;    &lt;span class="k"&gt;except&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSLWantReadError&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-13"&gt;&lt;code data-line-number="13"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-13" name="rest_code_095f5aea8f354d988a71f02eb47a8651-13"&gt;&lt;/a&gt;        &lt;span class="n"&gt;server_hello&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-14"&gt;&lt;code data-line-number="14"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-14" name="rest_code_095f5aea8f354d988a71f02eb47a8651-14"&gt;&lt;/a&gt;        &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;server_hello&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-15"&gt;&lt;code data-line-number="15"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-15" name="rest_code_095f5aea8f354d988a71f02eb47a8651-15"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-16"&gt;&lt;code data-line-number="16"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-16" name="rest_code_095f5aea8f354d988a71f02eb47a8651-16"&gt;&lt;/a&gt;    &lt;span class="n"&gt;client_fin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4096&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-17"&gt;&lt;code data-line-number="17"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-17" name="rest_code_095f5aea8f354d988a71f02eb47a8651-17"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client_fin&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-18"&gt;&lt;code data-line-number="18"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-18" name="rest_code_095f5aea8f354d988a71f02eb47a8651-18"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;do_handshake&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-19"&gt;&lt;code data-line-number="19"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-19" name="rest_code_095f5aea8f354d988a71f02eb47a8651-19"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-20"&gt;&lt;code data-line-number="20"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-20" name="rest_code_095f5aea8f354d988a71f02eb47a8651-20"&gt;&lt;/a&gt;    &lt;span class="n"&gt;server_fin&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-21"&gt;&lt;code data-line-number="21"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-21" name="rest_code_095f5aea8f354d988a71f02eb47a8651-21"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;server_fin&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-22"&gt;&lt;code data-line-number="22"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-22" name="rest_code_095f5aea8f354d988a71f02eb47a8651-22"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-23"&gt;&lt;code data-line-number="23"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-23" name="rest_code_095f5aea8f354d988a71f02eb47a8651-23"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-24"&gt;&lt;code data-line-number="24"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-24" name="rest_code_095f5aea8f354d988a71f02eb47a8651-24"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;make_tls_objects&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-25"&gt;&lt;code data-line-number="25"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-25" name="rest_code_095f5aea8f354d988a71f02eb47a8651-25"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_in_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-26"&gt;&lt;code data-line-number="26"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-26" name="rest_code_095f5aea8f354d988a71f02eb47a8651-26"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_out_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;MemoryBIO&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-27"&gt;&lt;code data-line-number="27"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-27" name="rest_code_095f5aea8f354d988a71f02eb47a8651-27"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-28"&gt;&lt;code data-line-number="28"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-28" name="rest_code_095f5aea8f354d988a71f02eb47a8651-28"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ctx&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SSLContext&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ssl&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;PROTOCOL_SSLv23&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-29"&gt;&lt;code data-line-number="29"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-29" name="rest_code_095f5aea8f354d988a71f02eb47a8651-29"&gt;&lt;/a&gt;    &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;load_cert_chain&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s1"&gt;'localhost.crt'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s1"&gt;'private_key.pem'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-30"&gt;&lt;code data-line-number="30"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-30" name="rest_code_095f5aea8f354d988a71f02eb47a8651-30"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_obj&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ctx&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wrap_bio&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;server_side&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="kc"&gt;True&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-31"&gt;&lt;code data-line-number="31"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-31" name="rest_code_095f5aea8f354d988a71f02eb47a8651-31"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-32"&gt;&lt;code data-line-number="32"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-32" name="rest_code_095f5aea8f354d988a71f02eb47a8651-32"&gt;&lt;/a&gt;    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-33"&gt;&lt;code data-line-number="33"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-33" name="rest_code_095f5aea8f354d988a71f02eb47a8651-33"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-34"&gt;&lt;code data-line-number="34"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-34" name="rest_code_095f5aea8f354d988a71f02eb47a8651-34"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-35"&gt;&lt;code data-line-number="35"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-35" name="rest_code_095f5aea8f354d988a71f02eb47a8651-35"&gt;&lt;/a&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;respond_to_http_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt; &lt;span class="o"&gt;-&amp;gt;&lt;/span&gt; &lt;span class="kc"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-36"&gt;&lt;code data-line-number="36"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-36" name="rest_code_095f5aea8f354d988a71f02eb47a8651-36"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;make_tls_objects&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-37"&gt;&lt;code data-line-number="37"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-37" name="rest_code_095f5aea8f354d988a71f02eb47a8651-37"&gt;&lt;/a&gt;    &lt;span class="n"&gt;do_tls_handshake&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-38"&gt;&lt;code data-line-number="38"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-38" name="rest_code_095f5aea8f354d988a71f02eb47a8651-38"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-39"&gt;&lt;code data-line-number="39"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-39" name="rest_code_095f5aea8f354d988a71f02eb47a8651-39"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_in_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;4096&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-40"&gt;&lt;code data-line-number="40"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-40" name="rest_code_095f5aea8f354d988a71f02eb47a8651-40"&gt;&lt;/a&gt;    &lt;span class="n"&gt;http_req&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-41"&gt;&lt;code data-line-number="41"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-41" name="rest_code_095f5aea8f354d988a71f02eb47a8651-41"&gt;&lt;/a&gt;    &lt;span class="nb"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;http_req&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-42"&gt;&lt;code data-line-number="42"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-42" name="rest_code_095f5aea8f354d988a71f02eb47a8651-42"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-43"&gt;&lt;code data-line-number="43"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-43" name="rest_code_095f5aea8f354d988a71f02eb47a8651-43"&gt;&lt;/a&gt;    &lt;span class="n"&gt;tls_obj&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="sa"&gt;b&lt;/span&gt;&lt;span class="s1"&gt;'HTTP/1.1 200 OK&lt;/span&gt;&lt;span class="se"&gt;\r\n\r\n&lt;/span&gt;&lt;span class="s1"&gt;'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-44"&gt;&lt;code data-line-number="44"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-44" name="rest_code_095f5aea8f354d988a71f02eb47a8651-44"&gt;&lt;/a&gt;    &lt;span class="n"&gt;sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sendall&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tls_out_buff&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-45"&gt;&lt;code data-line-number="45"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-45" name="rest_code_095f5aea8f354d988a71f02eb47a8651-45"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-46"&gt;&lt;code data-line-number="46"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-46" name="rest_code_095f5aea8f354d988a71f02eb47a8651-46"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-47"&gt;&lt;code data-line-number="47"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-47" name="rest_code_095f5aea8f354d988a71f02eb47a8651-47"&gt;&lt;/a&gt;&lt;span class="n"&gt;server_sock&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-48"&gt;&lt;code data-line-number="48"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-48" name="rest_code_095f5aea8f354d988a71f02eb47a8651-48"&gt;&lt;/a&gt;&lt;span class="n"&gt;server_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bind&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s1"&gt;'0.0.0.0'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="mi"&gt;5000&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-49"&gt;&lt;code data-line-number="49"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-49" name="rest_code_095f5aea8f354d988a71f02eb47a8651-49"&gt;&lt;/a&gt;&lt;span class="n"&gt;server_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;listen&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;65535&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-50"&gt;&lt;code data-line-number="50"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-50" name="rest_code_095f5aea8f354d988a71f02eb47a8651-50"&gt;&lt;/a&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-51"&gt;&lt;code data-line-number="51"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-51" name="rest_code_095f5aea8f354d988a71f02eb47a8651-51"&gt;&lt;/a&gt;&lt;span class="n"&gt;client_sock&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;_&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;server_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;accept&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-52"&gt;&lt;code data-line-number="52"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-52" name="rest_code_095f5aea8f354d988a71f02eb47a8651-52"&gt;&lt;/a&gt;&lt;span class="n"&gt;respond_to_http_request&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;client_sock&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class="linenos linenodiv"&gt;&lt;a href="http://blog.povilasb.com/posts/python-ssl-memorybio-usage/#rest_code_095f5aea8f354d988a71f02eb47a8651-53"&gt;&lt;code data-line-number="53"&gt;&lt;/code&gt;&lt;/a&gt;&lt;/td&gt;&lt;td class="code"&gt;&lt;code&gt;&lt;a id="rest_code_095f5aea8f354d988a71f02eb47a8651-53" name="rest_code_095f5aea8f354d988a71f02eb47a8651-53"&gt;&lt;/a&gt;&lt;span class="n"&gt;client_sock&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/code&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/div&gt;&lt;/section&gt;</description><category>python</category><category>python3</category><category>ssl</category><category>tls</category><guid>http://blog.povilasb.com/posts/python-ssl-memorybio-usage/</guid><pubDate>Tue, 07 Feb 2017 16:47:23 GMT</pubDate></item></channel></rss>