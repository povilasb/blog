<!DOCTYPE html>
<html prefix="
og: http://ogp.me/ns# article: http://ogp.me/ns/article#
" lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Machine learning in 3 lines of code | Povilas Blog</title>
<link href="../../assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta name="theme-color" content="#5670d4">
<meta name="generator" content="Nikola (getnikola.com)">
<link rel="alternate" type="application/rss+xml" title="RSS" hreflang="en" href="../../rss.xml">
<link rel="canonical" href="http://blog.povilasb.com/posts/machine-learning-intro/">
<!--[if lt IE 9]><script src="../../assets/js/html5.js"></script><![endif]--><meta name="author" content="Povilas Balciunas">
<link rel="prev" href="../boost-deps-analyzer/" title="Boost dependency analyzer" type="text/html">
<link rel="next" href="../running-python-async-function/" title="Running Python async function" type="text/html">
<meta property="og:site_name" content="Povilas Blog">
<meta property="og:title" content="Machine learning in 3 lines of code">
<meta property="og:url" content="http://blog.povilasb.com/posts/machine-learning-intro/">
<meta property="og:description" content="This is a very light introduction into machine learning.
I will demonstrate how to solve one specific problem using
scikit-learn, a machine learning framework in
just 3 lines of code.

Problem
I creat">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2016-08-06T21:34:00-05:00">
<meta property="article:tag" content="ml">
<meta property="article:tag" content="python">
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-expand-md static-top mb-4
navbar-dark
bg-dark
"><div class="container">
<!-- This keeps the margins nice -->
        <a class="navbar-brand" href="../../">

            <span id="blog-title">Povilas Blog</span>
        </a>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="bs-navbar">
            <ul class="navbar-nav mr-auto">
<li class="nav-item">
<a href="../../archive.html" class="nav-link">Archive</a>
                </li>
<li class="nav-item">
<a href="../../categories/" class="nav-link">Tags</a>
                </li>
<li class="nav-item">
<a href="../../rss.xml" class="nav-link">RSS feed</a>

                
            </li>
</ul>
<ul class="navbar-nav navbar-right">
<li class="nav-item">
    <a href="index.rst" id="sourcelink" class="nav-link">Source</a>
    </li>

                
            </ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        
<article class="post-text h-entry hentry postpage" itemscope="itemscope" itemtype="http://schema.org/Article"><header><h1 class="p-name entry-title" itemprop="headline name"><a href="." class="u-url">Machine learning in 3 lines of code</a></h1>

        <div class="metadata">
            <p class="byline author vcard p-author h-card"><span class="byline-name fn p-name" itemprop="author">
                    Povilas Balciunas
            </span></p>
            <p class="dateline">
            <a href="." rel="bookmark">
            <time class="published dt-published" datetime="2016-08-06T21:34:00-05:00" itemprop="datePublished" title="2016-08-06 21:34">2016-08-06 21:34</time></a>
            </p>
                <p class="commentline">    

                    </p>
<p class="sourceline"><a href="index.rst" class="sourcelink">Source</a></p>

        </div>
        
    </header><div class="e-content entry-content" itemprop="articleBody text">
    <p>This is a very light introduction into machine learning.
I will demonstrate how to solve one specific problem using
<a class="reference external" href="http://scikit-learn.org/">scikit-learn</a>, a machine learning framework in
just 3 lines of code.</p>
<section id="problem"><h2>Problem</h2>
<p>I created a syntetic problem where data is very simple so we don't have
to struggle with distilling it.</p>
<p>Based on very simple rules we have labeled points on a coordinate plane.
If x &gt; 0 and y &lt; 0 then the point is labeled as <em>X</em>.
If x &lt; 0 and y &gt; 0 then the point is labeled as 'O'.</p>
<pre class="literal-block">   o        ^ y
       o    |
     o      |
            |
------------+-------------&gt; x
            |    x
            |       x
            |  x</pre>
<p>Our task is to label any given point.</p>
<p><strong>Input</strong>: (x, y)</p>
<p><strong>Output</strong>: X or O</p>
<p>E.g.</p>
<p><strong>Input</strong>: (1, -7)</p>
<p><strong>Output</strong>: <em>X</em></p>
</section><section id="manual-solution"><h2>Manual solution</h2>
<p>In this case to implement the classification manually using if statements is
really easy:</p>
<div class="code"><pre class="code python"><a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-1" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-1" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-1"></a><span class="k">def</span> <span class="nf">label_for</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-2" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-2" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-2"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-3" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-3" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-3"></a>        <span class="k">return</span> <span class="s1">'o'</span>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-4" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-4" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-4"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-5" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-5" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-5"></a>        <span class="k">return</span> <span class="s1">'x'</span>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-6" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-6" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-6"></a>
<a id="rest_code_20d166dccb324d2b91be176b01cb0dcb-7" name="rest_code_20d166dccb324d2b91be176b01cb0dcb-7" href="#rest_code_20d166dccb324d2b91be176b01cb0dcb-7"></a>    <span class="k">return</span> <span class="s1">'?'</span>
</pre></div>
<p>Anyway let's compare with the machine learning implementation.</p>
</section><section id="machine-learning-solution"><h2>Machine learning solution</h2>
<div class="code"><pre class="code python"><a id="rest_code_76187e2246334fafa548e9600353b810-1" name="rest_code_76187e2246334fafa548e9600353b810-1" href="#rest_code_76187e2246334fafa548e9600353b810-1"></a><span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsClassifier</span>
<a id="rest_code_76187e2246334fafa548e9600353b810-2" name="rest_code_76187e2246334fafa548e9600353b810-2" href="#rest_code_76187e2246334fafa548e9600353b810-2"></a>
<a id="rest_code_76187e2246334fafa548e9600353b810-3" name="rest_code_76187e2246334fafa548e9600353b810-3" href="#rest_code_76187e2246334fafa548e9600353b810-3"></a><span class="kn">import</span> <span class="nn">coords</span>
<a id="rest_code_76187e2246334fafa548e9600353b810-4" name="rest_code_76187e2246334fafa548e9600353b810-4" href="#rest_code_76187e2246334fafa548e9600353b810-4"></a>
<a id="rest_code_76187e2246334fafa548e9600353b810-5" name="rest_code_76187e2246334fafa548e9600353b810-5" href="#rest_code_76187e2246334fafa548e9600353b810-5"></a><span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<a id="rest_code_76187e2246334fafa548e9600353b810-6" name="rest_code_76187e2246334fafa548e9600353b810-6" href="#rest_code_76187e2246334fafa548e9600353b810-6"></a><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">training_data</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">make_n_random</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<a id="rest_code_76187e2246334fafa548e9600353b810-7" name="rest_code_76187e2246334fafa548e9600353b810-7" href="#rest_code_76187e2246334fafa548e9600353b810-7"></a><span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]))</span>
</pre></div>
<p>Basically the last 3 lines of code create the classifier, train it with
sample data and predict the labels for the given sample coordinates.
The full solution code is in
<a class="reference external" href="https://github.com/povilasb/machine-learning/blob/master/labeled-coordinates/x_o.py">https://github.com/povilasb/machine-learning/blob/master/labeled-coordinates/x_o.py</a>.
If we run it, we get the output:</p>
<pre class="literal-block">['x' 'o']</pre>
<p>Meaning (1, -7) was labeled as 'x' and (-1, 7) as 'o'.
Which is correct.</p>
<p>Let's take a deeper look how this actually works.</p>
<section id="obtain-data"><h3>Obtain data</h3>
<p>To make our classifier understand which coordinates have which labels we
must train it with the sample data.</p>
<p>We will not get training data from anywhere. Instead we will generate it.
We'll use <cite>generate_n_random()</cite> function from
<a class="reference external" href="https://github.com/povilasb/machine-learning/blob/master/labeled-coordinates/coords.py">coords</a>
module to generate N coordinates that comply with my given rules.
Basically, this function returns a list of labeled coordinates:</p>
<div class="code"><pre class="code python"><a id="rest_code_14bc8cbcca0d4677b77ecfb55b19c4b6-1" name="rest_code_14bc8cbcca0d4677b77ecfb55b19c4b6-1" href="#rest_code_14bc8cbcca0d4677b77ecfb55b19c4b6-1"></a><span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="s1">'x'</span><span class="p">),</span> <span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">'y'</span><span class="p">),</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</section><section id="scrub-data"><h3>Scrub data</h3>
<p><cite>coords.make_n_random()</cite> generates labeled coordinates in a different format
than the <cite>scikit-learn</cite> classifier expects.
So we need to reformat our training data.</p>
<p>That's where we use <cite>training_data()</cite> function:</p>
<div class="code"><pre class="code python"><a id="rest_code_f21860db033c4e709976bea2500e8852-1" name="rest_code_f21860db033c4e709976bea2500e8852-1" href="#rest_code_f21860db033c4e709976bea2500e8852-1"></a><span class="k">def</span> <span class="nf">training_data</span><span class="p">(</span><span class="n">coordinates</span><span class="p">):</span>
<a id="rest_code_f21860db033c4e709976bea2500e8852-2" name="rest_code_f21860db033c4e709976bea2500e8852-2" href="#rest_code_f21860db033c4e709976bea2500e8852-2"></a>    <span class="sd">"""Converts coordinates to classifier acceptable format."""</span>
<a id="rest_code_f21860db033c4e709976bea2500e8852-3" name="rest_code_f21860db033c4e709976bea2500e8852-3" href="#rest_code_f21860db033c4e709976bea2500e8852-3"></a>    <span class="k">return</span> <span class="p">(</span>
<a id="rest_code_f21860db033c4e709976bea2500e8852-4" name="rest_code_f21860db033c4e709976bea2500e8852-4" href="#rest_code_f21860db033c4e709976bea2500e8852-4"></a>        <span class="p">[[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">],</span>
<a id="rest_code_f21860db033c4e709976bea2500e8852-5" name="rest_code_f21860db033c4e709976bea2500e8852-5" href="#rest_code_f21860db033c4e709976bea2500e8852-5"></a>        <span class="p">[</span><span class="n">label</span> <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">coordinates</span><span class="p">]</span>
<a id="rest_code_f21860db033c4e709976bea2500e8852-6" name="rest_code_f21860db033c4e709976bea2500e8852-6" href="#rest_code_f21860db033c4e709976bea2500e8852-6"></a>    <span class="p">)</span>
</pre></div>
<p>It separates coordinates and labels into two separate arrays.</p>
</section><section id="classify-new-data"><h3>Classify new data</h3>
<p>Once we have preprocessed data we can continue with training the model
and classifying new coordinates:</p>
<div class="code"><pre class="code python"><a id="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-1" name="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-1" href="#rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-1"></a><span class="n">clf</span> <span class="o">=</span> <span class="n">KNeighborsClassifier</span><span class="p">()</span>
<a id="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-2" name="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-2" href="#rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-2"></a><span class="n">clf</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="o">*</span><span class="n">training_data</span><span class="p">(</span><span class="n">coords</span><span class="o">.</span><span class="n">make_n_random</span><span class="p">(</span><span class="mi">100</span><span class="p">)))</span>
<a id="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-3" name="rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-3" href="#rest_code_ea9f515e0dee4257b39a51c3cc48fa4d-3"></a><span class="nb">print</span><span class="p">(</span><span class="n">clf</span><span class="o">.</span><span class="n">predict</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">]]))</span>
</pre></div>
<p><cite>KNeighborsClassifier</cite> is a python class that implements the
<a class="reference external" href="https://en.wikipedia.org/wiki/K-nearest_neighbors_algorithm">k-nearest neighbors algorithm</a>.</p>
<p><cite>clf.fit()</cite> trains the classifier with the given labeled data.</p>
<p><cite>clf.predict()</cite> returns predicted labels for the specified coordinates.</p>
</section></section><section id="machine-learning-vs-manual-solution"><h2>Machine learning vs manual solution</h2>
<p>In this case it's obvious that solving the problem with if statements
is way easier: you don't need to gather any data, scrub it, etc.</p>
<p>But what if our input data changes as time goes by?</p>
<p>Let's say now every coordinate where x &gt; 0 and y &gt; 0 is labeled as 's':</p>
<pre class="literal-block">   o        ^ y
       o    |    s
     o      |       s
            | s
------------+-------------&gt; x
            |    x
            |       x
            |  x</pre>
<p>In a machine learning-based implementation we don't need to change anything.
We just have to retrain the model with new data.</p>
<p>If we implemented the classification manually, we would have to program a new
rule:</p>
<div class="code"><pre class="code python"><a id="rest_code_8d41a3417576489fb9cc31e19fb07252-1" name="rest_code_8d41a3417576489fb9cc31e19fb07252-1" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-1"></a><span class="k">def</span> <span class="nf">label_for</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-2" name="rest_code_8d41a3417576489fb9cc31e19fb07252-2" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-2"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-3" name="rest_code_8d41a3417576489fb9cc31e19fb07252-3" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-3"></a>        <span class="k">return</span> <span class="s1">'o'</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-4" name="rest_code_8d41a3417576489fb9cc31e19fb07252-4" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-4"></a>    <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-5" name="rest_code_8d41a3417576489fb9cc31e19fb07252-5" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-5"></a>        <span class="k">return</span> <span class="s1">'x'</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-6" name="rest_code_8d41a3417576489fb9cc31e19fb07252-6" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-6"></a><span class="o">+</span>   <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-7" name="rest_code_8d41a3417576489fb9cc31e19fb07252-7" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-7"></a><span class="o">+</span>       <span class="k">return</span> <span class="s1">'s'</span>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-8" name="rest_code_8d41a3417576489fb9cc31e19fb07252-8" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-8"></a>
<a id="rest_code_8d41a3417576489fb9cc31e19fb07252-9" name="rest_code_8d41a3417576489fb9cc31e19fb07252-9" href="#rest_code_8d41a3417576489fb9cc31e19fb07252-9"></a>    <span class="k">return</span> <span class="s1">'?'</span>
</pre></div>
</section><section id="conclusions"><h2>Conclusions</h2>
<p>When we use a framework it might be really easy to solve problems using
machine learning.</p>
<p>The example problem was easy to implement using if statements.
But any input data changes require to adopt the algorithm.
Also, in real life scenarios problems are not that simple.
For example if we wanted to recognize digits in an image we should program
10 different cases for different digits.
Also, if the digit font changes, we would have to adopt code, etc.
Using machine learning all we need to do is to train our model with new data.
And this is way more scalable.</p>
<p>So machine learning helps to solve a lot of otherwise unsolvable problems.
And we don't really need to understand the maths behind it because
there are great tools that do the job for us.</p>
</section><section id="environment-setup"><h2>Environment setup</h2>
<p>I used the <cite>scikit-learn</cite> framework with python 3.
It depends on a lot of other packages.
So if you dont have <cite>scikit-learn</cite> installed on your machine,
I created a <a class="reference external" href="https://hub.docker.com/r/povilasb/scikit-learn/">Docker container</a>.</p>
<p>Now all you have to do to run your python script in this environment is:</p>
<pre class="literal-block">$ docker run -it --rm=true -v `pwd`:/tmp/ml povilasb/scikit-learn python3 /tmp/ml/x_o.py</pre>
<p>This command will download Docker image, create a container, run the
specified script in it and finally destroy it.</p>
</section>
</div>
    <aside class="postpromonav"><nav><ul itemprop="keywords" class="tags">
<li><a class="tag p-category" href="../../categories/ml/" rel="tag">ml</a></li>
            <li><a class="tag p-category" href="../../categories/python/" rel="tag">python</a></li>
        </ul>
<ul class="pager hidden-print">
<li class="previous">
                <a href="../boost-deps-analyzer/" rel="prev" title="Boost dependency analyzer">Previous post</a>
            </li>
            <li class="next">
                <a href="../running-python-async-function/" rel="next" title="Running Python async function">Next post</a>
            </li>
        </ul></nav></aside><section class="comments hidden-print"><h2>Comments</h2>
            

        </section></article><!--End of body content--><footer id="footer">
            Contents © 2022         <a href="mailto:balciunas90@gmail.com">Povilas Balciunas</a> - Powered by         <a href="https://getnikola.com" rel="nofollow">Nikola</a>         
            
        </footer>
</div>
</div>

        <script src="../../assets/js/all-nocdn.js"></script><script>
    baguetteBox.run('div#content', {
        ignoreClass: 'islink',
        captions: function(element){var i=element.getElementsByTagName('img')[0];return i===undefined?'':i.alt;}});
    </script>
</body>
</html>
